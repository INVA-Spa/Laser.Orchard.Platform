window.ecommerceData=$.extend(!0,{},window.ecommerceData);window.ecommerceData.detail=$.extend(!0,{},window.ecommerceData.detail);window.ecommerceData.detail.products=window.ecommerceData.detail.products||[];window.ecommerceData.impressions=window.ecommerceData.impressions||[];window.ecommerceData.cart=$.extend(!0,{},window.ecommerceData.cart);window.ecommerceData.cart.products=window.ecommerceData.cart.products||[];$(function(){var r,n,t;window.ecommerceData=$.extend(!0,{},window.ecommerceData);window.ecommerceData.detail=$.extend(!0,{},window.ecommerceData.detail);window.ecommerceData.detail.products=window.ecommerceData.detail.products||[];window.ecommerceData.impressions=window.ecommerceData.impressions||[];window.ecommerceData.cart=$.extend(!0,{},window.ecommerceData.cart);window.ecommerceData.cart.products=window.ecommerceData.cart.products||[];r={};r.impressions=window.ecommerceData.impressions;window.ecommerceData.detail.products.length&&(r.detail=window.ecommerceData.detail);window.dataLayer=window.dataLayer||[];window.dataLayer.push({ecommerce:r});n=function(n,t){var u={},r;for(i=0;i<n.length;i++)if(r=n[i],r.partId==t){u=r;break}return u};t=function(t){var u=$(t).find(".quantity"),e,o,c,s,f,h,r;if(u&&u.length){for(e=[],o=[],i=0;i<u.length;i++)if(c=$(u[i]).attr("data-cart-product-id"),s=$(u[i]).val(),c&&s){if(f=n(window.ecommerceData.cart.products,c),$.isEmptyObject(f))break;s!=f.quantity&&(h=s-f.quantity,r={},r=Object.assign(r,f),h>0?(r.quantity=h,e.push(r)):(r.quantity=-h,o.push(r)))}e.length&&window.dataLayer.push({event:"addToCart",ecommerce:{add:{products:e}}});o.length&&window.dataLayer.push({event:"removeFromCart",ecommerce:{remove:{products:o}}})}};$(document).on("nwazet.addedtocart","form.addtocart",function(){var i=$(this).serializeArray().reduce(function(n,t){return n[t.name]=t.value,n},{}),r=i.id,t=n(window.ecommerceData.detail.products,r),u;($.isEmptyObject(t)&&(t=n(window.ecommerceData.impressions,r)),$.isEmptyObject(t))||(u=i.quantity,t.quantity=u,window.dataLayer.push({event:"addToCart",ecommerce:{add:{products:[t]}}}))}).on("nwazet.removefromcart",".shoppingcart .delete",function(){var i=$(this).attr("data-cart-product-id"),t=n(window.ecommerceData.cart.products,i);$.isEmptyObject(t)||(t.quantity>0&&(window.dataLayer.push({event:"removeFromCart",ecommerce:{remove:{products:[t]}}}),t.quantity=0),console.log("removefromcart"))}).on("nwazet.cartupdated",function(){console.log("cartupdated")}).on("change",".shoppingcart .quantity",function(){var r=$(this).attr("data-cart-product-id"),i=n(window.ecommerceData.cart.products,r),t;$.isEmptyObject(i)||(t=$(this).val(),i.currentQuantity=t,console.log("quantity changed to "+t))}).on("submit",".shopping-cart-container form",function(n){t(n.target)}).on("submit",".shoppingcart form",function(n){t(n.target)}).on("submit","form .shopping-cart-container",function(n){t(n.target)}).on("submit","form .shoppingcart",function(n){t(n.target)}).on("submit",function(){})});